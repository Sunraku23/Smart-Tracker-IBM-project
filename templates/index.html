<!DOCTYPE html>
<html>
<head>
    <title>Smart Tracker</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="container mt-4">

    <h1 class="mb-4">üìöüé¨ Smart Movie/Anime/Book Tracker</h1>

    <a href="{{ url_for('add_item_route') }}" class="btn btn-success mb-3">‚ûï Add New Item</a>

    <div class="alert alert-secondary mt-4">
        ü§ñ Want a <strong>recommended movie</strong> or to <strong>search for an anime/book</strong>?  
        <a href="{{ url_for('ask_ai') }}" class="btn btn-sm btn-outline-primary">
            Ask AI Assistant
        </a>
    </div>

    <form method="GET" action="{{ url_for('index') }}" class="row g-3 mb-3">
        <!-- Sort -->
        <div class="col-md-4">
            <label for="sort_by" class="form-label">Sort by:</label>
            <select name="sort_by" id="sort_by" class="form-select" onchange="this.form.submit()">
            <option value="">-- Default --</option>
            <option value="title" {% if sort_by == 'title' %}selected{% endif %}>Title</option>
            <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>Rating</option>
            <option value="status" {% if sort_by == 'status' %}selected{% endif %}>Status</option>
            <option value="category" {% if sort_by == 'category' %}selected{% endif %}>Category</option>
            <option value="genre" {% if sort_by == 'genre' %}selected{% endif %}>Genre</option>
            </select>
        </div>

        <!-- Filter by Category -->
        <div class="col-md-4">
            <label for="filter_category" class="form-label">Filter Category:</label>
            <select name="filter_category" id="filter_category" class="form-select" onchange="this.form.submit()">
            <option value="">-- All --</option>
            <option value="Anime" {% if filter_category == 'Anime' %}selected{% endif %}>Anime</option>
            <option value="Movie" {% if filter_category == 'Movie' %}selected{% endif %}>Movie</option>
            <option value="Book" {% if filter_category == 'Book' %}selected{% endif %}>Book</option>
            </select>
        </div>

        <!-- Filter by Genre -->
        <div class="col-md-4">
            <label for="filter_genre" class="form-label">Filter Genre:</label>
            <select name="filter_genre" id="filter_genre" class="form-select" onchange="this.form.submit()">
            <option value="">-- All --</option>
            <option value="Action" {% if filter_genre == 'Action' %}selected{% endif %}>Action</option>
            <option value="Fantasy" {% if filter_genre == 'Fantasy' %}selected{% endif %}>Fantasy</option>
            <option value="Romance" {% if filter_genre == 'Romance' %}selected{% endif %}>Romance</option>
            </select>
        </div>
    </form>


    <h2>All Items</h2>
    {% if items %}
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Genre</th>
                    <th>Rating</th>
                    <th>Status</th>
                    <th>Added</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                    <tr>
                        <td>{{ item['title'] }}</td>
                        <td>{{ item['category'] }}</td>
                        <td>{{ item['genre'] }}</td>
                        <td>{{ item['rating'] }}</td>
                        <td>{{ item['status'] }}</td>
                        <td>{{ item['added_date'] }}</td>
                        <td>
                            <a href="{{ url_for('edit_item_route', item_id=item['id']) }}" class="btn btn-warning btn-sm">‚úèÔ∏è Edit</a>
                            <a href="{{ url_for('delete_item_route', item_id=item['id']) }}" 
                               class="btn btn-danger btn-sm"
                               onclick="return confirm('Are you sure you want to delete {{ item['title'] }}?');">
                               üóë Delete
                            </a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="alert alert-info">No items yet. Add one!</div>
    {% endif %}
</body>
</html>
